<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrícula Online - CCML</title>
    <link rel="stylesheet" href="css/style.css?v=1.0.16">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Biblioteca EmailJS para envio de e-mails -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>

    <nav>
        <div class="logo">CCML</div>
        <button class="mobile-menu-btn" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></button>
        <ul class="nav-links">
            <li><a href="index.html">Início</a></li>
            <li><a href="matricula.html" style="color: var(--gold);">Matrícula</a></li>
            <li><a href="valores_ccml.html">Valores</a></li>
            <li><a href="painel_professor.html" class="btn-nav">Área do Professor</a></li>
        </ul>
    </nav>

    <div class="main-container">
        <div class="form-box animate-on-scroll fade-up">
            <div class="form-header">
                <i class="fa-solid fa-music" style="font-size: 2.5rem; color: var(--gold); margin-bottom: 15px;"></i>
                <h2>Ficha de Matrícula</h2>
                <p>Preencha os dados abaixo para iniciar sua jornada musical no CCML.</p>
            </div>
            
            <!-- Mensagem de Sucesso (Oculta inicialmente) -->
            <div id="successMessage" style="display:none; text-align: center; padding: 20px;">
                <i class="fa-solid fa-circle-check" style="color: var(--gold); font-size: 3rem; margin-bottom: 20px;"></i>
                <h3 style="margin-bottom: 10px;">Matrícula Enviada!</h3>
                <p style="color: #666; margin-bottom: 20px;">Recebemos seus dados com sucesso. Nossa equipe entrará em contato em breve.</p>
                <a href="index.html" class="btn-main">Voltar ao Início</a>
            </div>

            <form id="formMatricula" onsubmit="handleEnrollment(event)">
                <!-- Barra de Progresso -->
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>

                <!-- 1. BLOCO QUEM É (Identificação) -->
                <fieldset class="form-section form-step active">
                <h3><i class="fa-solid fa-user"></i> 1. Identificação do Aluno</h3>
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label>Nome Completo:</label>
                        <input type="text" id="nomeAluno" required placeholder="Ex: João da Silva">
                    </div>
                    
                    <div class="input-group">
                        <label>Data de Nascimento:</label>
                        <input type="date" id="dataNascimento" required>
                    </div>
                    
                    <div class="input-group">
                        <label>Idade:</label>
                        <input type="text" id="idade" readonly style="background-color: #f9f9f9; cursor: not-allowed;">
                    </div>

                    <div class="input-group">
                        <label>CPF (do Aluno):</label>
                        <input type="text" id="cpf" placeholder="000.000.000-00" required maxlength="14">
                    </div>

                    <div class="input-group">
                        <label>WhatsApp:</label>
                        <input type="tel" id="telefone" placeholder="(94) 99999-9999" required>
                    </div>
                    
                    <div class="input-group full-width">
                        <label>Endereço Completo:</label>
                        <input type="text" id="endereco" placeholder="Rua, Número, Bairro" required>
                    </div>

                    <div class="input-group full-width">
                        <label>E-mail:</label>
                        <input type="email" id="email" placeholder="exemplo@email.com" required>
                    </div>
                </div>
                </fieldset>

                <!-- 2. BLOCO QUEM PAGA (Financeiro) -->
                <fieldset class="form-section form-step">
                <h3><i class="fa-solid fa-file-invoice-dollar"></i> 2. Responsável Financeiro</h3>
                <div style="margin-bottom: 15px;">
                    <label style="display: inline-flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="checkMesmoResponsavel" style="width: auto; margin-right: 10px;" onchange="toggleResponsavel()">
                        <span style="font-size: 0.9rem; color: #555;">O aluno é o responsável financeiro (Maior de 18 anos)</span>
                    </label>
                </div>

                <div class="form-grid" id="blocoResponsavel">
                    <div class="input-group full-width">
                        <label>Nome do Responsável Financeiro:</label>
                        <input type="text" id="nomeResponsavel" placeholder="Nome do pagador" required>
                    </div>
                    <div class="input-group">
                        <label>CPF do Responsável:</label>
                        <input type="text" id="cpfResponsavel" placeholder="000.000.000-00" maxlength="14" required>
                    </div>
                    <div class="input-group">
                        <label>WhatsApp:</label>
                        <input type="tel" id="whatsappCobranca" placeholder="(94) 99999-9999" required>
                    </div>
                    <div class="input-group">
                        <label>Dia de Vencimento:</label>
                        <select id="diaVencimento" required>
                            <option value="05">Dia 05</option>
                            <option value="10">Dia 10</option>
                        </select>
                    </div>
                </div>
                </fieldset>

                <!-- 3. BLOCO O QUE ESTUDA (Pedagógico) -->
                <fieldset class="form-section form-step">
                <h3><i class="fa-solid fa-music"></i> 3. Dados do Curso</h3>

                <div class="form-grid">
                    <div class="input-group full-width">
                        <label>Instrumento/Curso:</label>
                        <select id="curso" required>
                            <option value="" disabled selected>Selecione um instrumento...</option>
                            <option value="Piano/Teclado">Piano / Teclado</option>
                            <option value="Violão">Violão</option>
                            <option value="Violino">Violino</option>
                            <option value="Bateria">Bateria</option>
                            <option value="Canto/Técnica Vocal">Canto / Técnica Vocal</option>
                            <option value="Flauta Doce">Flauta Doce</option>
                            <option value="Inglês com Música">Inglês com Música</option>
                            <option value="musicalizacao">Musicalização Infantil</option>
                            <option value="Outro">Outro</option>
                        </select>
                        <input type="text" id="outroCurso" placeholder="Qual instrumento?" style="display:none; margin-top: 5px;">
                        <div id="avisoMusicalizacao" style="display:none; background: #fffbf0; border: 1px solid var(--gold); padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 0.9rem; color: #555;">
                            <i class="fa-solid fa-circle-info" style="color: var(--gold); margin-right: 8px;"></i>
                            Para crianças de 6 anos ou menos, o curso é direcionado para Musicalização Infantil, focando no desenvolvimento cognitivo e motor.
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Nível Musical:</label>
                        <select id="nivel" required>
                            <option value="iniciante">Iniciante (Nunca toquei)</option>
                            <option value="basico">Básico (Já tive aulas / Até 6 meses)</option>
                            <option value="intermediario">Intermediário (Já toco / 1 a 3 anos)</option>
                            <option value="avancado">Avançado (Domínio técnico / +3 anos)</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Possui Instrumento Próprio?</label>
                        <select id="instrumentoProprio" required>
                            <option value="nao">Não</option>
                            <option value="sim">Sim</option>
                        </select>
                    </div>

                    <div class="input-group full-width">
                        <label>Qual o objetivo da aula?</label>
                        <input type="text" id="objetivo" placeholder="Ex: Hobby, Desenvolvimento Cognitivo, Terapêutico/Saúde, Profissionalização" list="objetivos-list" required>
                        <datalist id="objetivos-list">
                            <option value="Hobby">
                            <option value="Desenvolvimento Cognitivo">
                            <option value="Terapêutico/saúde">
                            <option value="Profissionalização">
                        </datalist>
                    </div>

                    <div class="input-group full-width">
                        <label>Disponibilidade de Horário (Marque suas preferências):</label>
                        <div style="margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <label style="font-weight: 600; color: var(--gold); margin-bottom: 5px; display:block;">Dias:</label>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    <label class="chip-option"><input type="checkbox" name="diasPref" value="Segunda"> <span>Seg</span></label>
                                    <label class="chip-option"><input type="checkbox" name="diasPref" value="Terça"> <span>Ter</span></label>
                                    <label class="chip-option"><input type="checkbox" name="diasPref" value="Quarta"> <span>Qua</span></label>
                                    <label class="chip-option"><input type="checkbox" name="diasPref" value="Quinta"> <span>Qui</span></label>
                                    <label class="chip-option"><input type="checkbox" name="diasPref" value="Sexta"> <span>Sex</span></label>
                                    <label class="chip-option"><input type="checkbox" name="diasPref" value="Sábado"> <span>Sáb</span></label>
                                </div>
                            </div>
                            <div>
                                <label style="font-weight: 600; color: var(--gold); margin-bottom: 5px; display:block;">Turnos:</label>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    <label class="chip-option"><input type="checkbox" name="turnosPref" value="Manhã"> <span>Manhã</span></label>
                                    <label class="chip-option"><input type="checkbox" name="turnosPref" value="Tarde"> <span>Tarde</span></label>
                                    <label class="chip-option"><input type="checkbox" name="turnosPref" value="Noite"> <span>Noite</span></label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </fieldset>

                <!-- 4. BLOCO SEGURANÇA JURÍDICA -->
                <fieldset class="form-section form-step">
                <h3><i class="fa-solid fa-heart-pulse"></i> 4. Saúde e Bem-estar</h3>
                
                <div class="input-group full-width">
                    <label>Para oferecermos a melhor experiência de aprendizado, há algo sobre a saúde ou desenvolvimento que gostaria de compartilhar?</label>
                    <textarea id="necessidades" rows="3" placeholder="Este é um espaço seguro. Conte-nos se o aluno tem alguma alergia, sensibilidade ou condição específica (ex: TDAH, TEA) para que possamos acolhê-lo da melhor forma."></textarea>
                </div>
                </fieldset>

                <fieldset class="form-section form-step">
                <h3><i class="fa-solid fa-hand-holding-dollar"></i> 5. Escolha seu Plano</h3>
                
                <div class="input-group full-width">
                    <label>Selecione a modalidade de ensino:</label>
                    <div class="plans-container">
                        <label class="plan-card">
                            <input type="radio" name="plano" value="Turma" required>
                            <div class="plan-content">
                                <span class="plan-title">Aula em Turma</span>
                                <span class="plan-price">R$ 189,90 <small>/mês</small></span>
                                <span class="plan-desc">Aprendizado em grupo</span>
                            </div>
                        </label>

                        <label class="plan-card">
                            <input type="radio" name="plano" value="Individual">
                            <div class="plan-content">
                                <span class="plan-title">Aula Individual</span>
                                <span class="plan-price">R$ 250,00 <small>/mês</small></span>
                                <span class="plan-desc">Foco exclusivo</span>
                            </div>
                        </label>

                        <label class="plan-card">
                            <input type="radio" name="plano" value="Musicalizacao" disabled>
                            <div class="plan-content">
                                <span class="plan-title">Musicalização Infantil</span>
                                <span class="plan-price">R$ 199,90 <small>/mês</small></span>
                                <span class="plan-desc">Educação Musical (até 6 anos)</span>
                            </div>
                        </label>

                        <label class="plan-card">
                            <input type="radio" name="plano" value="Ingles" disabled>
                            <div class="plan-content">
                                <span class="plan-title">Inglês com Música</span>
                                <span class="plan-price">R$ 250,00 <small>/mês</small></span>
                                <span class="plan-desc">Aprendizado em grupo</span>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Resumo Financeiro Automático -->
                <div id="resumoFinal" style="background: #fffbf0; padding: 20px; border: 1px solid var(--gold); border-radius: 10px; margin-top: 20px; display:none;">
                    <h4 style="color: var(--gold); margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px;">Resumo da Matrícula</h4>
                    <p><strong>Aluno:</strong> <span id="resumoNome"></span></p>
                    <p><strong>Curso:</strong> <span id="resumoCurso"></span></p>
                    <p><strong>Plano Selecionado:</strong> <span id="resumoPlano">Aguardando seleção...</span></p>
                    <p style="font-size: 1.2rem; margin-top: 10px; border-top: 1px dashed #ccc; padding-top: 10px;"><strong>Total Mensal:</strong> <span id="resumoValor" style="color: green; font-weight: 800;">R$ 0,00</span></p>
                </div>

                <div class="input-group full-width" style="margin-top: 10px;">
                    <label style="display: flex; align-items: flex-start; cursor: pointer;">
                        <input type="checkbox" id="autorizacaoImagem" style="width: auto; margin-right: 10px; margin-top: 4px;">
                        <span style="font-size: 0.9rem; color: #555; line-height: 1.4;">Autorizo o uso da minha imagem (ou do menor sob minha responsabilidade) para fins de divulgação nas redes sociais da escola.</span>
                    </label>
                </div>
                </fieldset>

                <!-- Navegação do Formulário -->
                <div class="form-navigation">
                    <button type="button" id="prevBtn" class="btn-nav-form btn-prev" onclick="nextPrev(-1)" style="display:none;">Voltar</button>
                    <button type="button" id="nextBtn" class="btn-nav-form btn-next" onclick="nextPrev(1)">Avançar</button>
                    <button type="submit" id="submitBtn" class="btn-submit" style="display:none; background-color: green; color: white; margin-top:0;">
                        FINALIZAR MATRÍCULA
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="footer-container"></div>

    <!-- Modal de Erro (Pop-up Visual) -->
    <div id="errorModal" class="error-modal-overlay">
        <div class="error-modal-content">
            <div class="error-icon"><i class="fa-solid fa-circle-exclamation"></i></div>
            <h3 class="error-title">Atenção!</h3>
            <p id="errorText" class="error-msg">Ocorreu um erro.</p>
            <button onclick="closeErrorModal()" class="btn-error-close">Entendi, vou corrigir</button>
        </div>
    </div>

    <!-- Script Principal -->
    <script type="module" src="js/app.js?v=1.0.16"></script>
</body>
</html>