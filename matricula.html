<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrícula Online - CCML</title>
    <link rel="stylesheet" href="css/style.css?v=1.0.1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Biblioteca EmailJS para envio de e-mails -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>
<body>

    <nav>
        <div class="logo">CCML</div>
        <button class="mobile-menu-btn" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></button>
        <ul class="nav-links">
            <li><a href="index.html">Início</a></li>
            <li><a href="matricula.html" style="color: var(--gold);">Matrícula</a></li>
            <li><a href="valores_ccml.html">Valores</a></li>
            <li><a href="painel_professor.html" class="btn-nav">Área do Professor</a></li>
        </ul>
    </nav>

    <div class="main-container">
        <div class="form-box animate-on-scroll fade-up">
            <h2>Nova Matrícula - CCML</h2>
            <p class="subtitle">Preencha os dados abaixo para cadastrar um novo aluno no sistema.</p>
            
            <!-- Mensagem de Sucesso (Oculta inicialmente) -->
            <div id="successMessage" style="display:none; text-align: center; padding: 20px;">
                <i class="fa-solid fa-circle-check" style="color: var(--gold); font-size: 3rem; margin-bottom: 20px;"></i>
                <h3 style="margin-bottom: 10px;">Matrícula Enviada!</h3>
                <p style="color: #666; margin-bottom: 20px;">Recebemos seus dados com sucesso. Nossa equipe entrará em contato em breve.</p>
                <a href="index.html" class="btn-main">Voltar ao Início</a>
            </div>

            <form id="formMatricula" onsubmit="handleEnrollment(event)">
                <!-- Barra de Progresso -->
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>

                <!-- 1. BLOCO QUEM É (Identificação) -->
                <div class="form-section form-step active">
                <h3><i class="fa-solid fa-user"></i> 1. Identificação do Aluno</h3>
                <div class="form-grid">
                    <div class="input-group full-width">
                        <label>Nome Completo:</label>
                        <input type="text" id="nomeAluno" required placeholder="Ex: João da Silva">
                    </div>
                    
                    <div class="input-group">
                        <label>Data de Nascimento:</label>
                        <input type="date" id="dataNascimento" required>
                    </div>
                    
                    <div class="input-group">
                        <label>Idade:</label>
                        <input type="text" id="idade" readonly style="background-color: #f9f9f9; cursor: not-allowed;">
                    </div>

                    <div class="input-group">
                        <label>CPF (do Aluno ou Responsável):</label>
                        <input type="text" id="cpf" placeholder="000.000.000-00" required maxlength="14">
                    </div>
                    
                    <div class="input-group full-width">
                        <label>Endereço Completo:</label>
                        <input type="text" id="endereco" placeholder="Rua, Número, Bairro" required>
                    </div>

                    <div class="input-group full-width">
                        <label>E-mail:</label>
                        <input type="email" id="email" placeholder="exemplo@email.com">
                    </div>
                </div>
                </div>

                <!-- 2. BLOCO QUEM PAGA (Financeiro) -->
                <div class="form-section form-step">
                <h3><i class="fa-solid fa-file-invoice-dollar"></i> 2. Responsável Financeiro</h3>
                <div style="margin-bottom: 15px;">
                    <label style="display: inline-flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="checkMesmoResponsavel" style="width: auto; margin-right: 10px;" onchange="toggleResponsavel()">
                        <span style="font-size: 0.9rem; color: #555;">O aluno é o responsável financeiro (Maior de 18 anos)</span>
                    </label>
                </div>

                <div class="form-grid" id="blocoResponsavel">
                    <div class="input-group full-width">
                        <label>Nome do Responsável Financeiro:</label>
                        <input type="text" id="nomeResponsavel" placeholder="Nome do pagador">
                    </div>
                    <div class="input-group">
                        <label>CPF do Responsável:</label>
                        <input type="text" id="cpfResponsavel" placeholder="000.000.000-00" maxlength="14">
                    </div>
                    <div class="input-group">
                        <label>WhatsApp de Cobrança:</label>
                        <input type="tel" id="whatsappCobranca" placeholder="(94) 99999-9999">
                    </div>
                    <div class="input-group">
                        <label>Dia de Vencimento:</label>
                        <select id="diaVencimento">
                            <option value="05">Dia 05</option>
                            <option value="10">Dia 10</option>
                            <option value="15">Dia 15</option>
                            <option value="20">Dia 20</option>
                        </select>
                    </div>
                </div>
                </div>

                <!-- 3. BLOCO O QUE ESTUDA (Pedagógico) -->
                <div class="form-section form-step">
                <h3><i class="fa-solid fa-music"></i> 3. Dados do Curso</h3>

                <div class="form-grid">
                    <div class="input-group full-width">
                        <label>Instrumento/Curso:</label>
                        <select id="curso" required>
                            <option value="" disabled selected>Selecione um instrumento...</option>
                            <option value="Piano/Teclado">Piano / Teclado</option>
                            <option value="Violão">Violão</option>
                            <option value="Violino">Violino</option>
                            <option value="Bateria">Bateria</option>
                            <option value="Canto/Técnica Vocal">Canto / Técnica Vocal</option>
                            <option value="Saxofone">Saxofone</option>
                            <option value="Musicalização Infantil">Musicalização Infantil</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Nível Musical:</label>
                        <select id="nivel">
                            <option value="iniciante">Iniciante (Nunca toquei)</option>
                            <option value="basico">Básico</option>
                            <option value="intermediario">Intermediário</option>
                            <option value="avancado">Avançado</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Possui Instrumento Próprio?</label>
                        <select id="instrumentoProprio">
                            <option value="nao">Não</option>
                            <option value="sim">Sim</option>
                        </select>
                    </div>

                    <div class="input-group full-width">
                        <label>Qual o objetivo da aula?</label>
                        <input type="text" id="objetivo" placeholder="Ex: Hobby, Desenvolvimento Cognitivo, Terapêutico, Profissionalização" list="objetivos-list">
                        <datalist id="objetivos-list">
                            <option value="Hobby">
                            <option value="Desenvolvimento Cognitivo">
                            <option value="Terapêutico">
                            <option value="Profissionalização">
                        </datalist>
                    </div>

                    <div class="input-group">
                        <label>Professor Vinculado:</label>
                        <input type="text" id="professor" placeholder="Nome do Professor">
                    </div>

                    <div class="input-group">
                        <label>Dia da Aula (Fixo):</label>
                        <select id="diaAula">
                            <option value="" disabled selected>Selecione...</option>
                            <option value="segunda">Segunda-feira</option>
                            <option value="terca">Terça-feira</option>
                            <option value="quarta">Quarta-feira</option>
                            <option value="quinta">Quinta-feira</option>
                            <option value="sexta">Sexta-feira</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Horário (Fixo):</label>
                        <input type="time" id="horarioAula">
                    </div>
                </div>
                </div>

                <!-- 4. BLOCO SEGURANÇA JURÍDICA -->
                <div class="form-section form-step">
                <h3><i class="fa-solid fa-heart-pulse"></i> 4. Saúde e Diagnósticos</h3>
                
                <div class="input-group full-width">
                    <label>Possui alguma necessidade especial ou diagnóstico? (TEA, TDAH, etc):</label>
                    <textarea id="necessidades" rows="2" placeholder="Descreva aqui se houver..."></textarea>
                </div>
                </div>

                <div class="form-section form-step">
                <h3><i class="fa-solid fa-calendar-check"></i> 5. Aula Experimental</h3>
                <div class="form-grid">
                    <div class="input-group">
                        <label>Data Agendada:</label>
                        <input type="date" id="dataExperimental">
                    </div>
                    <div class="input-group">
                        <label>Horário:</label>
                        <input type="time" id="horarioExperimental">
                    </div>
                </div>

                <div class="input-group full-width" style="margin-top: 10px;">
                    <label style="display: flex; align-items: flex-start; cursor: pointer;">
                        <input type="checkbox" id="autorizacaoImagem" style="width: auto; margin-right: 10px; margin-top: 4px;">
                        <span style="font-size: 0.9rem; color: #555; line-height: 1.4;">Autorizo o uso da minha imagem (ou do menor sob minha responsabilidade) para fins de divulgação nas redes sociais da escola.</span>
                    </label>
                </div>
                </div>

                <!-- Navegação do Formulário -->
                <div class="form-navigation">
                    <button type="button" id="prevBtn" class="btn-nav-form btn-prev" onclick="nextPrev(-1)" style="display:none;">Voltar</button>
                    <button type="button" id="nextBtn" class="btn-nav-form btn-next" onclick="nextPrev(1)">Avançar</button>
                    <button type="submit" id="submitBtn" class="btn-submit" style="display:none; background-color: green; color: white; margin-top:0;">
                        FINALIZAR MATRÍCULA
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="footer-container"></div>

    <!-- Modal de Erro (Pop-up Visual) -->
    <div id="errorModal" class="error-modal-overlay">
        <div class="error-modal-content">
            <div class="error-icon"><i class="fa-solid fa-circle-exclamation"></i></div>
            <h3 class="error-title">Atenção!</h3>
            <p id="errorText" class="error-msg">Ocorreu um erro.</p>
            <button onclick="closeErrorModal()" class="btn-error-close">Entendi, vou corrigir</button>
        </div>
    </div>

    <!-- Script Principal -->
    <script type="module" src="js/app.js?v=1.0.1"></script>
</body>
</html>